var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(c,f){return Object.prototype.hasOwnProperty.call(c,f)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,f,a){if(c==Array.prototype||c==Object.prototype)return c;c[f]=a.value;return c};$jscomp.getGlobal=function(c){c=["object"==typeof globalThis&&globalThis,c,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var f=0;f<c.length;++f){var a=c[f];if(a&&a.Math==Math)return a}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(c,f){var a=$jscomp.propertyToPolyfillSymbol[f];if(null==a)return c[f];a=c[a];return void 0!==a?a:c[f]};
$jscomp.polyfill=function(c,f,a,b){f&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(c,f,a,b):$jscomp.polyfillUnisolated(c,f,a,b))};$jscomp.polyfillUnisolated=function(c,f,a,b){a=$jscomp.global;c=c.split(".");for(b=0;b<c.length-1;b++){var d=c[b];if(!(d in a))return;a=a[d]}c=c[c.length-1];b=a[c];f=f(b);f!=b&&null!=f&&$jscomp.defineProperty(a,c,{configurable:!0,writable:!0,value:f})};
$jscomp.polyfillIsolated=function(c,f,a,b){var d=c.split(".");c=1===d.length;b=d[0];b=!c&&b in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var e=0;e<d.length-1;e++){var g=d[e];if(!(g in b))return;b=b[g]}d=d[d.length-1];a=$jscomp.IS_SYMBOL_NATIVE&&"es6"===a?b[d]:null;f=f(a);null!=f&&(c?$jscomp.defineProperty($jscomp.polyfills,d,{configurable:!0,writable:!0,value:f}):f!==a&&(void 0===$jscomp.propertyToPolyfillSymbol[d]&&(a=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[d]=$jscomp.IS_SYMBOL_NATIVE?
    $jscomp.global.Symbol(d):$jscomp.POLYFILL_PREFIX+a+"$"+d),$jscomp.defineProperty(b,$jscomp.propertyToPolyfillSymbol[d],{configurable:!0,writable:!0,value:f})))};$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(c,f){for(var a=1;a<arguments.length;a++){var b=arguments[a];if(b)for(var d in b)$jscomp.owns(b,d)&&(c[d]=b[d])}return c};$jscomp.polyfill("Object.assign",function(c){return c||$jscomp.assign},"es6","es3");
(function(c){var f=function(a,b){this.$T=c(a);this._options=c.extend(!0,{autoHideBreadcrumb:!1},b);this._$target=c(a);this._currentFolder="/";this._enableDragDrop=window.FormData&&"draggable"in document.createElement("span");this._init(a,b);return this};f.prototype._init=function(a,b){var d=this,e=d.$fm=c('<div class="jquery_fm" />').appendTo(d._$target.empty()),g=d.$explorer=c('<div class="explorer" />').appendTo(e),h=d.$files=c('<div class="files" />').appendTo(g);d.onDestroy=[];var k=c('<div class="upload-tools" />');
    if(b.allow_upload){c('<a class="btn btn-success upload" />').text(b.strings.add_file).prepend('<i class="icon-plus"></i>').append(c('<input type="file" name="files[]" multiple="">').change(function(){d._upload(this.files);var m=c(this).clone(!0);c("<form></form>").append(m)[0].reset();c(this).replaceWith(m)})).appendTo(k);if(d._enableDragDrop){jQuery.event.props&&jQuery.event.props.push("dataTransfer");var l=b.drag_selector?c(b.drag_selector):g;l.bind(d._namespaceEvents(["drop","dragenter","dragover"]),
        function(m){var n=m.originalEvent&&m.originalEvent.dataTransfer;n&&-1!==c.inArray("Files",n.types)&&(m.preventDefault(),"drop"==m.type?d._upload(n.files):(n.dropEffect="copy",l.add(g).toggleClass("drag-hover",!0)))}).bind(d._namespaceEvents(["drop","mouseleave","dragend","dragleave"]),function(m){l.add(g).toggleClass("drag-hover",!1)});d.onDestroy.push(function(){l.unbind(".jquery_fm")});c('<div class="drag-drop-message" />').append('<i class="icon-download"></i>').append(b.strings.drop_files).append("<br />").append(c("<small />").text(b.strings.max_file_size.replace("%",
        b.max_file_size_readable))).appendTo(g)}if(b.allow_paste_upload)c(document).on("paste",function(m){m=m.originalEvent&&m.originalEvent.clipboardData&&m.originalEvent.clipboardData.items;var n=[];m&&m.length&&(c.each(m,function(p,q){var r=q.getAsFile&&q.getAsFile();r&&n.push(r)}),d._upload(n))})}b.allow_folders&&b.allow_editing&&c('<a class="btn btn-info folder" />').text(b.strings.create_folder).prepend('<i class="icon-folder-open"></i>').click(function(){d._ask(d._options.strings.create_folder,d._options.strings.create_folder_prompt,
        !0,function(m){d._request(null,"create_folder",{name:m},function(n){n.file&&d._createFile(n.file).hide().appendTo(d.$files).show("slow")})});return!1}).appendTo(k);0<k.children().length&&e.append(k);"undefined"===typeof b.files?d.navigateTo("/"):c(b.files).each(function(){h.append(d._createFile(this))});d._updateBreadcrumb()};f.prototype.currentFiles=function(){var a=[];this.$files.children(".file").each(function(){a.push(c(this).data("file"))});return a};f.prototype.currentFolder=function(){return this._currentFolder};
    f.prototype.navigateTo=function(a){var b=this;if(b._options.allow_folders){a=a.replace(/\/+/g,"/");var d=b.$explorer.find(".files").fadeOut("normal",function(){c(this).html('<div class="loader" />').fadeIn("normal")});b._request(null,"read",{folder:a},function(e){b._currentFolder=a;d.stop(!0,!0).fadeTo("normal",1).empty();c(e.files).each(function(){b._createFile(this).hide().appendTo(b.$files).fadeTo("slow",1)});b._updateBreadcrumb()},function(){d.stop(!0,!0).empty().append(c('<a href="#" />').text(b._options.strings.try_again).click(function(){b.navigateTo(a);
        return!1}))})}return this.$T};f.prototype._request=function(a,b,d,e,g,h){var k=this,l={};if(d instanceof FormData){var m=d;m.append("action",b);l.processData=!1;l.contentType=!1}else m=c.extend({action:b},d),"undefined"==typeof m.folder&&(m.folder=k._currentFolder);h&&(l.xhr=function(){var n=jQuery.ajaxSettings.xhr()||new window.XMLHttpRequest;n.upload&&n.upload.addEventListener("progress",function(p){p.lengthComputable&&h({loaded:event.loaded,total:event.total,progress:event.loaded/event.total*100|
            0})},!1);return n});l=c.extend(l,{type:"POST",url:k._options.ajax_endpoint,data:m,dataType:"json",cache:!1,success:function(n){a&&a.find(".error").fadeOut("slow",function(){c(this).remove()});e&&e(n)},error:function(n){n=k._options.strings[n.responseJSON&&n.responseJSON.message]||k._options.strings.error;if(a)k._setError(a,n);else{var p=c("<p />").append(c('<span class="label label-danger" />').text(n)).hide().prependTo(k.$fm).fadeIn();window.setTimeout(function(){p.fadeOut("slow",function(){p.remove()})},
            2E4)}g&&g(m)}});l=c.extend(l,k._options.ajax_config||{});return c.ajax(l)};f.prototype._namespaceEvents=function(a){return a.map(function(b){return""+b+".jquery_fm"}).join(" ")};f.prototype._setError=function(a,b){c('<span class="error" />').text("!").attr("title",b).hide().prependTo(a).fadeOut("fast").fadeIn("fast").fadeOut("fast").fadeIn("fast").fadeOut("fast").fadeIn("fast");a.attr("title",b).find(".cancel").remove()};f.prototype._findByName=function(a){return this.$files.children(".file").filter(function(){return c(this).data("file").name==
        a})};f.prototype._prepareFileDrag=function(a,b){var d=this;d._enableDragDrop&&d._options.allow_folders&&a.bind("drop dragenter dragover",function(e){var g=e.originalEvent&&e.originalEvent.dataTransfer;if(g&&-1!==c.inArray("jquery_fm",g.types))if(e.preventDefault(),"drop"==e.type){e=g.getData("jquery_fm");var h=d._findByName(e);d._request(h,"rename",{file:e,destName:e,destFolder:b},function(k){h.hide("slow");a.is(".file")&&k.file&&a.find(".info").fadeOut("normal",function(){var l=d._createFile(k.file);
        l.find(".info").hide().fadeIn("slow");a.replaceWith(l)})})}else g.dropEffect="move",a.toggleClass("drag-hover",!0)}).bind("drop mouseleave dragend dragleave",function(){a.toggleClass("drag-hover",!1)})};f.prototype._createFile=function(a){var b=this,d=c('<div class="file" />').data("file",a);if(a.is_folder){var e=this._options.icons_url+"/folder.png";var g=function(){b.navigateTo(b._currentFolder+"/"+a.name)}}else e=this._options.icons_url+"/"+a.name.split(".").pop()+".png",g=function(){var h=b._options.force_downloads,
        k=b._options.ajax_endpoint+(-1==b._options.ajax_endpoint.indexOf("?")?"?":"&")+"action="+(h?"download":"show")+"&file="+a.name+"&folder="+b._currentFolder;if(h)c("<iframe>").hide().prop("src",k).appendTo("body");else{var l=window.open(k);l.onload=function(){l.document.title=a.name}}};c('<div class="icon" />').click(g).append(c("<img />").attr("draggable",!1).attr("src",a.icon||e).bind("error",function(h){c(this).unbind(h).attr("src",b._options.icons_url+"/unknown.png")})).appendTo(d);c("<h4 />").attr("title",
        a.name).text(a.name).appendTo(d);c('<div class="info" />').html(a.info).appendTo(d);a.title&&d.attr("title",a.title);e=c('<div class="tools" />');a.uploading?c('<a class="btn btn-sm btn-warning cancel" />').attr("title",b._options.strings.cancel_upload).prepend('<i class="icon-cancel"></i>').appendTo(e):!b._options.allow_editing||a.hasOwnProperty("allow_edit")&&1!=a.allow_edit||(c('<a class="btn btn-sm btn-danger delete" />').attr("title",b._options.strings["delete"]).prepend('<i class="icon-trash"></i>').click(function(){b._ask(b._options.strings["delete"],
        b._options.strings.confirm_delete,!1,function(){b._request(d,"delete",{file:a.name},function(){d.hide("slow",function(){d.remove();b._$target.trigger("delete",a)})})});return!1}).appendTo(e),c('<a class="btn btn-sm btn-info rename" />').attr("title",b._options.strings.rename).prepend('<i class="icon-edit"></i>').click(function(){b._ask(b._options.strings.rename,b._options.strings.prompt_newname,a.name,function(h){a.name!=h&&b._request(d,"rename",{file:a.name,destName:h},function(k){d.fadeOut("normal",
        function(){var l=b._createFile(k.file).hide().fadeTo("slow",1);d.replaceWith(l);b._$target.trigger("rename",a)})})});return!1}).appendTo(e));0<e.children().length&&e.appendTo(d);b._options.allow_folders&&(d.attr("draggable",!0).bind("dragstart",function(h){a.uploading||(h.dataTransfer.setData("Text",a.name),h.dataTransfer.setData("jquery_fm",a.name))}),a.is_folder&&b._prepareFileDrag(d,b._currentFolder+"/"+a.name));b._$target.trigger("create",a);return d};f.prototype._updateBreadcrumb=function(){if(this._options.allow_folders){var a=
        this,b=a.$explorer.find(".breadcrumb");b.length||(b=c('<ol class="breadcrumb" />').prependTo(a.$explorer));b.empty();var d=(""==a._currentFolder?"/":a._currentFolder).split("/");""==d[0]&&""==d[1]&&d.splice(0,1);if(1==d.length&&this._options.autoHideBreadcrumb)b.remove();else for(var e in d){var g=0==e?a._options.strings.home_folder:d[e];if(g.length)if(e==d.length-1)b.append('<li class="active">'+g+"</li>");else{var h=d.slice(0,parseInt(e)+1).join("/");g=c("<a />").text(g).data("folder",h).click(function(){a.navigateTo(c(this).data("folder"));
        return!1});b.append(c("<li />").append(g));a._prepareFileDrag(g,h)}}}};f.prototype._validate=function(a){var b="",d=new RegExp(this._options.accept_file_types,"i");!this._options.accept_file_types||d.test(a.type)||d.test(a.name)?a.size>this._options.max_file_size&&(b=this._options.strings.error_maxsize):b=this._options.strings.error_filetype;return{success:""==b,message:b}};f.prototype._upload=function(a,b){for(var d=this,e=0;e<a.length;e++)(function(g){var h=d._createFile({name:g.name||d._options.strings.unnamed,
        info:g.size?(g.size/1024|0)+" KB":"",is_folder:!1,uploading:!0}).hide().appendTo(d.$files).show("slow"),k=h.addClass("uploading").attr("title",d._options.strings.uploading).find(".icon");if("undefined"!=typeof FileReader&&g.type.match("image")){var l=new FileReader;l.onload=function(p){var q=new Image;q.src=p.target.result;k.find("img").replaceWith(q)};l.readAsDataURL(g)}l=d._validate(g);if(l.success){var m=!1;l=new FormData;l.append("folder",b||d._currentFolder);l.append("files[]",g);var n=d._request(h,
        "upload",l,function(p){m=!0;k.loader(100).loader(!1,function(){h.removeClass("uploading");p.file&&h.replaceWith(d._createFile(p.file));d._$target.trigger("upload",Object.assign({},{folder:b||d._currentFolder},p.file))})},function(){m=!0;k.loader(!1)},function(p){100==p.progress?c({val:85}).animate({val:100},{duration:3E3,step:function(){m||k.loader(this.val)}}):k.loader(.85*p.progress)});h.find(".cancel").click(function(){n.abort();h.hide("slow");return!1})}else d._setError(h,l.message)})(a[e])};
    f.prototype._ask=function(a,b,d,e,g){if(jQuery().modal){var h=!1!==d?c("<input />",{type:"text",id:"response","class":"form-control",value:!0===d?"":d,style:"width:85%",autofocus:!0}):c(),k=c('<div class="jquery_fm modal fade"> <div class="modal-dialog">   <div class="modal-content">   <div class="modal-header">    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>    <h4 class="modal-title"></h4>   </div> <div class="modal-body"></div>   <div class="modal-footer">  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>  <button type="button" class="btn btn-primary" data-dismiss="modal">Save changes</button> </div> </div></div></div>').first();
        k.find(".modal-title").text(a);k.find(".modal-body").text(b).append("<br/><br/>").append(h);var l=k.find(".btn-primary").text(this._options.strings.accept).click(function(){e(h.val())});k.find(".btn-default").text(this._options.strings.cancel).click(function(){g&&g()});h.keypress(function(m){13==m.which&&(m.preventDefault(),l.click())});k.modal("show").on("hidden",function(){k.remove()});0<h.length?h.focus():l.focus()}else(a=d?prompt(b,!0===d?"":d):confirm(b))?e(a):g&&g()};f.prototype.destroy=function(){c(this.onDestroy).each(function(a,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     b){b()});c(this.$T).removeData("jquery_fm")};c.fn.jquery_fm=function(a){if(!c(this).length)return c(this);var b=c(this).data("jquery_fm");if(b&&0!=a.indexOf("_")&&b[a]&&"function"==typeof b[a])return b[a].apply(b,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b?0==a.indexOf("_")?c.error("Method "+a+" is private!"):c.error("Method "+a+" does not exist."):c.error("Plugin must be initialised before using method: "+a);else return b=new f(c(this),a),c(this).data("jquery_fm",b),c(this)}})(jQuery);
(function(c){c.fn.loader=function(f,a){var b=function(e,g){for(var h in g){var k=g[h];c(["-moz","-ms","-o","-webkit"]).each(function(){e[this+"-"+h]=k})}return e},d=function(e){e.css({position:"absolute",left:e.parent().width()/2-e.width()/2+"px",top:e.parent().height()/2-e.height()/2+"px"})};return c(this).each(function(){var e=c(this),g=e.data("loader-pie"),h=!1;if(!g||0==g.parent().length){h=!0;g=c('<div><div><div class="loader-pie"></div></div><div class="loader-pie"></div></div>').hide().prependTo(e);
    e.data("loader-pie",g);var k=e.width(),l=e.height();var m=setInterval(function(){if(e.width()!==k||e.height()!==l)k=e.width(),l=e.height(),e.loader(e.data("loader-progress"))},200)}e.data("loader-progress",f);var n=function(q,r){g.animate({fontSize:q},{duration:400,step:function(t){d(g)},complete:function(){r&&r()}})};if(!1===f)n(0,function(){g.remove();e.removeData("loader-pie loader-progress");clearInterval(m);a&&a()});else{f=Math.min(f,100);e.css("position","relative");var p=Math.min(e.width(),
    e.height())/1.618;g.css({fontSize:p+"px",width:"1em",height:"1em",zIndex:99999});g.children().eq(0).css({overflow:"hidden",width:".5em",height:"1em",position:"absolute",left:50<f?0:".5em"}).children().first().css(b({width:"100%",height:"100%",borderRadius:".5em 0 0 .5em",position:"absolute",left:50<f?0:"-.5em"},{"transform-origin":"right center",transform:"rotate("+3.6*f+"deg)"}));g.children().eq(1).css({display:50<f?"block":"none",width:".5em",height:"1em",borderRadius:"0 .5em .5em 0",position:"absolute",
    left:".5em"});h?(g.show().css("fontSize",0),n(p)):d(g)}})}})(jQuery);